"""
Утилиты для валидации данных.
"""
from typing import Tuple, Optional


def validate_playlist_name(name: str) -> Tuple[bool, Optional[str]]:
    """
    Валидация названия плейлиста.
    
    Args:
        name: Название плейлиста для проверки
        
    Returns:
        Tuple[bool, Optional[str]]: (валидно, сообщение об ошибке)
        Если валидно = True, то error = None
        Если валидно = False, то error содержит понятное сообщение для пользователя
    """
    # Проверка на пустое название
    if not name:
        return False, "Название не может быть пустым."
    
    # Проверка на только пробелы
    if not name.strip():
        return False, "Название не может состоять только из пробелов."
    
    # Проверка длины (максимум 100 символов)
    if len(name) > 100:
        return False, "Название слишком длинное (максимум 100 символов)."
    
    # Проверка на несколько пробелов подряд
    if "  " in name:
        return False, "Название не должно содержать несколько пробелов подряд."
    
    # Проверка на недопустимые символы (разрешаем: буквы, цифры, пробелы, дефисы, подчеркивания, скобки, кавычки, знаки препинания)
    # Базовый набор разрешенных символов: буквы (включая кириллицу), цифры, пробелы, дефисы, подчеркивания
    # и основные знаки препинания
    allowed_chars = set(
        "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"
        "абвгдеёжзийклмнопрстуфхцчшщъыьэюяАБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ"
        "0123456789"
        " -_()[]{}.,!?;:'\""
    )
    
    # Проверяем, что все символы разрешены
    for char in name:
        if char not in allowed_chars:
            return False, f"Название содержит недопустимый символ: '{char}'. Используйте только буквы, цифры, пробелы и основные знаки препинания."
    
    return True, None

