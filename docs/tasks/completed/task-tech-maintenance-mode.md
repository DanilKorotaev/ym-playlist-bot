# –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∂–∏–º–∞ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç (Maintenance Mode)

**–°—Ç–∞—Ç—É—Å**: üìã –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: üî¥ –í—ã—Å–æ–∫–∏–π (–∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)  
**–ö–∞—Ç–µ–≥–æ—Ä–∏—è**: –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –±–∞–≥–∞—Ö –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö –≤ —Ä–µ–ª–∏–∑–µ –Ω—É–∂–Ω–æ –±—ã—Å—Ç—Ä–æ –æ—Ç–∫–ª—é—á–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±–æ—Ç–∞ –±–µ–∑ –ø–æ–ª–Ω–æ–π –æ—Å—Ç–∞–Ω–æ–≤–∫–∏.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –ë–æ—Ç –æ—Å—Ç–∞–µ—Ç—Å—è –∞–∫—Ç–∏–≤–Ω—ã–º –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
- –í—Å–µ –∫–æ–º–∞–Ω–¥—ã –∏ –¥–µ–π—Å—Ç–≤–∏—è –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–∞–±–æ—Ç–∞—Ö
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å —Ä–µ–∂–∏–º –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞

## –≠—Ç–∞–ø 1 - –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ ‚úÖ

### –ó–∞–¥–∞—á–∏

- [x] –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `MAINTENANCE_MODE` (true/false)
- [x] –°–æ–∑–¥–∞—Ç—å middleware/decorator –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∂–∏–º–∞ —Ç–µ—Ö—Ä–∞–±–æ—Ç
- [x] –ü—Ä–∏ `MAINTENANCE_MODE=true` –≤—Å–µ handlers –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "üîß –í–µ–¥—É—Ç—Å—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã. –ë–æ—Ç –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü—Ä–∏–Ω–æ—Å–∏–º –∏–∑–≤–∏–Ω–µ–Ω–∏—è –∑–∞ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞."
- [x] –û–±–Ω–æ–≤–∏—Ç—å `bot.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∂–∏–º–∞ –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤
- [x] –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ç–µ—Ö—Ä–∞–±–æ—Ç

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

- ‚úÖ –°–æ–∑–¥–∞–Ω middleware `MaintenanceMiddleware` –≤ `utils/maintenance_middleware.py`
- ‚úÖ Middleware –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è–º —á–µ—Ä–µ–∑ `dp.update.middleware()`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è `MAINTENANCE_MODE` –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –∑–∞–ø—Ä–æ—Å–∞
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ —Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω
- ‚úÖ –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã (–∏–∑ `ADMIN_IDS`) –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞ –¥–∞–∂–µ –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Ö—Ä–∞–±–æ—Ç

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. **–í–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ç–µ—Ö—Ä–∞–±–æ—Ç:**
   ```bash
   export MAINTENANCE_MODE=true
   ```

2. **–í—ã–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ç–µ—Ö—Ä–∞–±–æ—Ç:**
   ```bash
   export MAINTENANCE_MODE=false
   # –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
   unset MAINTENANCE_MODE
   ```

3. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):**
   ```bash
   export ADMIN_IDS="123456789,987654321"
   ```
   –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã —Å–º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞ –¥–∞–∂–µ –≤ —Ä–µ–∂–∏–º–µ —Ç–µ—Ö—Ä–∞–±–æ—Ç.

4. **–í Docker:**
   –î–æ–±–∞–≤—å—Ç–µ –≤ `docker-compose.yml`:
   ```yaml
   environment:
     - MAINTENANCE_MODE=false
     - ADMIN_IDS=123456789,987654321
   ```

### –§–∞–π–ª—ã

- `utils/maintenance.py` - —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∂–∏–º–∞ —Ç–µ—Ö—Ä–∞–±–æ—Ç (—Å–æ–¥–µ—Ä–∂–∏—Ç `MAINTENANCE_MESSAGE`)
- `utils/maintenance_middleware.py` - middleware –¥–ª—è –ø–µ—Ä–µ—Ö–≤–∞—Ç–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
- `bot.py` - –ø—Ä–∏–º–µ–Ω–µ–Ω middleware –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ `ADMIN_IDS`

## –≠—Ç–∞–ø 2 - –ê–¥–º–∏–Ω–∫–∞ (–±—É–¥—É—â–µ–µ)

### –ó–∞–¥–∞—á–∏

- [ ] –î–æ–±–∞–≤–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É `system_settings` –≤ –ë–î –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥ –≤ –ë–î –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è/—É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä–µ–∂–∏–º–∞ —Ç–µ—Ö—Ä–∞–±–æ—Ç
- [ ] –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—É `/maintenance` –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥ (—Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `ADMIN_IDS`)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∂–∏–º–∞: —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ë–î, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è (–ë–î –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)
- [ ] –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–π —Ä–µ–∂–∏–º–∞ —Ç–µ—Ö—Ä–∞–±–æ—Ç

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

- –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ë–î –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `system_settings`
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –º–µ—Ç–æ–¥—ã `get_maintenance_mode()`, `set_maintenance_mode()`
- –°–æ–∑–¥–∞—Ç—å –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥—É —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –û–±–Ω–æ–≤–∏—Ç—å middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ë–î –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç

–í—ã—Å–æ–∫–∏–π - –∫—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞, –ø–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞.

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `bot.py` - middleware –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∂–∏–º–∞
- `handlers/commands.py` - –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥–∞ `/maintenance`
- `database/` - —Ç–∞–±–ª–∏—Ü–∞ system_settings –∏ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–π

